groups:
- name: system_cpu
  rules:
  - alert: HighCPUUsage
    expr: sum(rate(process_cpu_seconds_total[5m])) > 0.8
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: High CPU usage detected
      description: CPU usage is above 80% for more than 1 minute.

- name: system_disk
  rules:
  - alert: DiskSpaceHigh
    expr: (node_filesystem_avail_bytes / node_filesystem_size_bytes * 100) < 10
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: Disk space running low
      description: Less than 10% disk space available on a filesystem.

- name: system_memory
  rules:
  - alert: HighMemoryUsage
    expr: (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) > 0.8
    for: 2m
    labels:
      severity: warning
    annotations:
      summary: High memory usage
      description: Memory usage is above 80% for more than 2 minutes.

- name: system_load
  rules:
  - alert: HighLoadAverage
    expr: node_load1 > 2 * count(node_cpu_seconds_total{mode="system"})
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: High system load
      description: Load average over 1 minute exceeds twice the number of CPU cores.
